| ID | Requirement | Description | Acceptance Criteria |
| --- | --- | --- | --- |
| **REQ-FIX-01** | **Async-Native Tool Execution** | Refactor the `Tool` class and `ToolRegistry` to support `async` execution, removing the blocking `asyncio.run()` call inside `_python_interpreter` in `src/tools.py`. | `Tool.execute` is an `async def`. `ResearchAgent` awaits the tool call. `nest_asyncio` is no longer strictly required for tool execution. |
| **REQ-FIX-02** | **Robust Action Parsing** | Update the regex in `src/agent.py` to handle tool arguments containing parentheses (e.g., code snippets). Replace `([^)]*)` with a greedy `(.*)` or a balanced parser. | The agent correctly parses `python_interpreter(print("Result: (10, 20)"))` without truncating at the first closing parenthesis. |
| **REQ-IMP-01** | **Semantic Text Splitting** | Replace the rigid character-index slicing in `src/ai_engine.py` (`text[i:i+MAX]`) with a recursive or whitespace-aware splitter to prevent cutting words/sentences in half. | Summaries are generated from complete sentences. No split words (e.g., "funct...ion") appear in the summary input logs. |
| **REQ-IMP-02** | **Optimized Vector Search** | Refactor `search_vectors` in `src/database.py` to eliminate N+1 query patterns. Modify the RPC or use a single batch query to fetch file paths and metadata for all chunks at once. | `search_vectors` performs max 2 DB calls (1 RPC + 1 batch metadata fetch) instead of 1 + N calls. Latency is reduced for search. |
| **REQ-IMP-03** | **Dynamic Synonym Management** | Move `ENTITY_SYNONYMS` from hardcoded Python dictionary in `src/ai_engine.py` to a database table or a dynamic configuration file. | Synonyms can be added/updated in the database without redeploying code. `AIEngine` loads these on initialization. |
| **REQ-IMP-04** | **Expanded Graph Search** | Increase the retrieval limit in `_graph_search` (currently 5) and optionally implement client-side reranking for graph results. | `graph_search` returns up to 20 relevant chunks, ensuring denser graph neighborhoods are better represented in the context. |